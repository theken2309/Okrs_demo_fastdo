@page "/"
@layout LayoutLogin
@*@page "/{id}"*@
@inject NavigationManager navigation
@inject IJSRuntime JSRuntime

<main id="login" style="overflow: hidden">
    <section class="login_fr">
        <!--!--><div class="login_form">
            <!--!--><div class="logo"><img src="/images/logo.png" alt="logo"></div><!--!--><h1 class="title is-size-2 is-size-5-mobile">
                Chào mừng đến với Fastdo
            </h1>
            <!--!--><div class="font_14">
                Tối ưu vận hành với bộ giải pháp công nghệ của Fastdo
            </div>
            <div data-gtm-form-interact-id="0">
                <!--!--><div class="title is-size-5">
                    Đăng nhập
                </div>
                <div class="control has-icons-left">
                    <input class="input" placeholder="Nhập email..." @bind="useLogin.nameUse" ><!--!-->
                    <!--!--><span class="icon is-left has-text-black"><i class="material-icons-round is-size-6">account_circle</i></span>
                </div><!--!-->
                <div class="control has-icons-left has-icons-right">
                    <input type="password" class="input" placeholder="Nhập mật khẩu..." autocomplete="current-password" data-gtm-form-interact-field-id="1"  @bind="@useLogin.password" ><!--!-->
                    <!--!--><span class="icon is-left has-text-black"><i class="material-icons-round is-size-6">lock</i></span><a class="icon is-right has-text-black"><!--!--><i class="material-icons-round is-size-6">visibility</i></a>
                </div><!--!-->
                <!--!--><div class="control">
                    <label class="checkbox">
                        <input type="checkbox" checked="">
                        <span class="is-size-7">Ghi nhớ mật khẩu</span>
                    </label>
                </div><button class="button is-link is-fullwidth mb-3 " @onclick="@(e=>Loginne(useLogin))"><!--!--><span class="is-size-7">Đăng nhập</span></button><!--!--><a class="button is-white is-fullwidth" href="/password"><span class="is-size-7">Quên mật khẩu?</span></a>
            </div><!--!-->
            <!--!--><div class="is-size-7">
                <span class="has-text-grey">
                    Đăng ký người dùng mới?
                </span>
                <a class="has-text-link has-text-weight-bold" href="/register">
                    Liên hệ ngay
                </a>
            </div><!--!--><div class="copyright">
                Copyright © 2022 FASTDO
            </div>
        </div>
    </section><!--!-->
    <section class="login_bg">
        <div class="carousel">
            <!--!--><div class="WMBSC" b-ym8nfzch4d="">
                <div class="WMBSC-content slick-initialized slick-slider slick-dotted" b-ym8nfzch4d="" _bl_6521da6e-576d-435e-b13a-6a220819c4cb="">
                    <div class="slick-list draggable">
                        <div class="slick-track" style="opacity: 1; width: 5400px; transform: translate3d(-3000px, 0px, 0px); transition: transform 300ms ease 0s;">
                            <div class="item slick-slide slick-cloned" data-slick-index="-1" id="" aria-hidden="true" style="width: 600px;" tabindex="-1">
                                <div class="item_image"><img src="/images/login/4.png" alt="img"></div><!--!-->
                                <div class="item_desc"><!--!-->Không chỉ là làm việc, Fastdo cung cấp không gian cho phép<br>mọi người phấn đấu và tận hưởng những thành tựu</div>
                            </div><div class="item slick-slide slick-current slick-active" data-slick-index="0" aria-hidden="false" style="width: 600px;" tabindex="-1" role="tabpanel" id="slick-slide00" aria-describedby="slick-slide-control00">
                                <div class="item_image"><img src="/images/login/1.png" alt="img"></div><!--!-->
                                <div class="item_desc"><!--!-->Doanh nghiệp dễ dàng thiết lập và theo dõi mục tiêu hiệu quả</div>
                            </div><div class="item slick-slide" data-slick-index="1" aria-hidden="true" style="width: 600px;" tabindex="-1" role="tabpanel" id="slick-slide01" aria-describedby="slick-slide-control01">
                                <div class="item_image"><img src="/images/login/2.png" alt="img"></div><!--!-->
                                <div class="item_desc"><!--!-->Nhân sự tăng hiệu suất vượt bậc khi dễ dàng thiết lập kế hoạch<br>công việc và tạo động lực làm việc vui vẻ hàng ngày</div>
                            </div><div class="item slick-slide" data-slick-index="2" aria-hidden="true" style="width: 600px;" tabindex="-1" role="tabpanel" id="slick-slide02" aria-describedby="slick-slide-control02">
                                <div class="item_image"><img src="/images/login/3.png" alt="img"></div><!--!-->
                                <div class="item_desc"><!--!-->Tương tác và thấu hiểu giữa những thành viên trong tổ chức.<br>Tạo động lực và thúc đẩy phát triển tổ chức</div>
                            </div><div class="item slick-slide" data-slick-index="3" aria-hidden="true" style="width: 600px;" tabindex="0" role="tabpanel" id="slick-slide03" aria-describedby="slick-slide-control03">
                                <div class="item_image"><img src="/images/login/4.png" alt="img"></div><!--!-->
                                <div class="item_desc"><!--!-->Không chỉ là làm việc, Fastdo cung cấp không gian cho phép<br>mọi người phấn đấu và tận hưởng những thành tựu</div>
                            </div><div class="item slick-slide slick-cloned" data-slick-index="4" id="" aria-hidden="true" style="width: 600px;" tabindex="-1">
                                <div class="item_image"><img src="/images/login/1.png" alt="img"></div><!--!-->
                                <div class="item_desc"><!--!-->Doanh nghiệp dễ dàng thiết lập và theo dõi mục tiêu hiệu quả</div>
                            </div><div class="item slick-slide slick-cloned" data-slick-index="5" id="" aria-hidden="true" style="width: 600px;" tabindex="-1">
                                <div class="item_image"><img src="/images/login/2.png" alt="img"></div><!--!-->
                                <div class="item_desc"><!--!-->Nhân sự tăng hiệu suất vượt bậc khi dễ dàng thiết lập kế hoạch<br>công việc và tạo động lực làm việc vui vẻ hàng ngày</div>
                            </div><div class="item slick-slide slick-cloned" data-slick-index="6" id="" aria-hidden="true" style="width: 600px;" tabindex="-1">
                                <div class="item_image"><img src="/images/login/3.png" alt="img"></div><!--!-->
                                <div class="item_desc"><!--!-->Tương tác và thấu hiểu giữa những thành viên trong tổ chức.<br>Tạo động lực và thúc đẩy phát triển tổ chức</div>
                            </div><div class="item slick-slide slick-cloned" data-slick-index="7" id="" aria-hidden="true" style="width: 600px;" tabindex="-1">
                                <div class="item_image"><img src="/images/login/4.png" alt="img"></div><!--!-->
                                <div class="item_desc"><!--!-->Không chỉ là làm việc, Fastdo cung cấp không gian cho phép<br>mọi người phấn đấu và tận hưởng những thành tựu</div>
                            </div>
                        </div>
                    </div>
                </div><!--!--><div class="WMBSC-loading" b-ym8nfzch4d="">Loading...</div>
            </div><!--!-->
            <div class="dots"><ul class="slick-dots" style="" role="tablist"><li class="slick-active" role="presentation"><button type="button" role="tab" id="slick-slide-control00" aria-controls="slick-slide00" aria-label="1 of 4" tabindex="-1">1</button></li><li role="presentation" class=""><button type="button" role="tab" id="slick-slide-control01" aria-controls="slick-slide01" aria-label="2 of 4" tabindex="-1">2</button></li><li role="presentation" class=""><button type="button" role="tab" id="slick-slide-control02" aria-controls="slick-slide02" aria-label="3 of 4" tabindex="-1">3</button></li><li role="presentation" class=""><button type="button" role="tab" id="slick-slide-control03" aria-controls="slick-slide03" aria-label="4 of 4" tabindex="0" aria-selected="true">4</button></li></ul></div>
            <div class="arrows"><a class="material-icons-round slick-arrow" style="">chevron_left</a><span class="material-icons-round slick-arrow" style="">chevron_right</span></div>
        </div>
    </section>
</main>

@code {
    UseModel useLogin = new();
    protected override async Task OnInitializedAsync()
    {
        // list = await DbUse.GetAll();
    }
    // getCookie(_user)
    // 1. co => id => DB => CÓ:  USer = DB
    // KHông: deleteCookie(_user) => return || naviate (/)

    // 2. khong => setCookie('_user', '11111111')
    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            string userID = await JSRuntime.InvokeAsync<string>("getCookie", "_user");
            if (userID == null)
            {
                navigation.NavigateTo("/");

            }
            else
            {
                Console.WriteLine(userID);
                navigation.NavigateTo("/homepage");

            }
        }
    }

    private async Task Loginne(UseModel uselogin )
    {
        
        Console.WriteLine("click");
        //check dung use
        var user = await  DbUse.CheckLogin(uselogin);
        @if(user != null)
        {
            Console.WriteLine(user.id);
            Console.WriteLine(user.nameUse);

            string userID = await JSRuntime.InvokeAsync<string>("setCookie", "_user", user.id);
            string userName = await JSRuntime.InvokeAsync<string>("setCookie", "_UserName", user.nameUse);
            string userQuyen = await JSRuntime.InvokeAsync<string>("setCookie", "_userQuyen", user.permisson);
            navigation.NavigateTo("/homepage");
        }
        else
        {
            Console.WriteLine("anlzluon");
        }
    }
        
}
